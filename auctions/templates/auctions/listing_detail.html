{% extends "auctions/base.html" %}

{% block content %}

<h1>{{ listing.title }}</h1>
<p>{{ listing.description }}</p>
<p>Base Price: KES. {{ listing.base_price }}</p>
<p>Start Time: {{ listing.start_time }}</p>
<p>End Time: {{ listing.end_time }}</p>
<p>Available Volume: 1</p>

<h2>Auction Status: {{ listing.auction.get_status_display }}</h2>

<h2>Offers Placed</h2>
<table style="width:100%; border-collapse: collapse;">
    <thead>
        <tr>
            <th style="border: 1px solid black; padding: 8px;">Amount</th>
            <th style="border: 1px solid black; padding: 8px;">Bidder</th>
            <th style="border: 1px solid black; padding: 8px;">Timestamp</th>
            <th style="border: 1px solid black; padding: 8px;">Status</th>
        </tr>
    </thead>
    <tbody>
        {% for bid in bids %}
            <tr>
                <td style="border: 1px solid black; padding: 8px;">KES. {{ bid.amount }}</td>
                <td style="border: 1px solid black; padding: 8px;">{{ bid.user.username }}</td>
                <td style="border: 1px solid black; padding: 8px;">{{ bid.timestamp }}</td>
                <td style="border: 1px solid black; padding: 8px;">
                    {% if bid.is_below_base_price %}
                        <span style="color: red;">Below Base Price</span>
                    {% else %}
                        Acceptable
                    {% endif %}
                </td>
            </tr>
        {% empty %}
            <tr>
                <td colspan="4" style="border: 1px solid black; padding: 8px; text-align: center;">No offers have been placed yet.</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<h2>Current Best Offer</h2>
{% if current_best_offer %}
    <p>KES. {{ current_best_offer.amount }} by {{ current_best_offer.user.username }}</p>
{% else %}
    <p>There is no current best offer.</p>
{% endif %}

<a href="{% url 'place_bid' listing.id %}">Place Bid</a>
<a href="{% url 'home' %}">Back to Auctions</a>

{% endblock %}
